<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Tarefa3_2022li1g011</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption empty">&nbsp;</span><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>Pedro Seabra Vieira &lt;a104352@alunos.uminho.pt&gt;<br />Pedro Filipe Maneta Pinto &lt;a104176@alunos.uminho.pt&gt;</td></tr><tr><th>Safe Haskell</th><td>Safe-Inferred</td></tr></table><p class="caption">Tarefa3_2022li1g011</p></div><div id="table-of-contents"><div id="contents-list"><p class="caption" onclick="window.scrollTo(0,0)">Contents</p><ul><li><a href="#g:1">Fun&#231;&#227;o principal</a></li><li><a href="#g:2">Fun&#231;&#245;es auxiliares</a></li></ul></div></div><div id="description"><p class="caption">Description</p><div class="doc"><p>M&#243;dulo para a realiza&#231;&#227;o da Tarefa 3 do projeto de LI1 em 2022/23.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:animaJogo">animaJogo</a> :: <a href="LI12223.html#t:Jogo" title="LI12223">Jogo</a> -&gt; <a href="LI12223.html#t:Jogada" title="LI12223">Jogada</a> -&gt; <a href="LI12223.html#t:Jogo" title="LI12223">Jogo</a></li><li class="src short"><a href="#v:moverObstaculos">moverObstaculos</a> :: <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a> -&gt; <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a></li><li class="src short"><a href="#v:atropelamento">atropelamento</a> :: Int -&gt; <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a> -&gt; <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a></li><li class="src short"><a href="#v:moverObstaculosLinha">moverObstaculosLinha</a> :: [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])] -&gt; [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])]</li><li class="src short"><a href="#v:atropelamentoLinha">atropelamentoLinha</a> :: Int -&gt; [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])] -&gt; [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])]</li><li class="src short"><a href="#v:moverObstaculosVelocidade">moverObstaculosVelocidade</a> :: [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])] -&gt; Int -&gt; (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])</li><li class="src short"><a href="#v:jogadorMove">jogadorMove</a> :: <a href="LI12223.html#t:Jogo" title="LI12223">Jogo</a> -&gt; <a href="LI12223.html#t:Jogada" title="LI12223">Jogada</a> -&gt; <a href="LI12223.html#t:Jogo" title="LI12223">Jogo</a></li><li class="src short"><a href="#v:qualTerrenoObs">qualTerrenoObs</a> :: <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a> -&gt; Int -&gt; (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])</li><li class="src short"><a href="#v:qualTerreno">qualTerreno</a> :: (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]) -&gt; <a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a></li><li class="src short"><a href="#v:qualObs">qualObs</a> :: (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]) -&gt; [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]</li><li class="src short"><a href="#v:listaTerrenos">listaTerrenos</a> :: [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])] -&gt; [<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>]</li><li class="src short"><a href="#v:qualV">qualV</a> :: (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]) -&gt; Int</li><li class="src short"><a href="#v:existeCarro">existeCarro</a> :: Int -&gt; (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]) -&gt; Bool</li><li class="src short"><a href="#v:localizarCarro">localizarCarro</a> :: Int -&gt; (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]) -&gt; Int</li><li class="src short"><a href="#v:atropelamentoAndar">atropelamentoAndar</a> :: [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])] -&gt; Int -&gt; (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])</li></ul></details></div><div id="interface"><a href="#g:1" id="g:1"><h1>Fun&#231;&#227;o principal</h1></a><div class="top"><p class="src"><a id="v:animaJogo" class="def">animaJogo</a> :: <a href="LI12223.html#t:Jogo" title="LI12223">Jogo</a> -&gt; <a href="LI12223.html#t:Jogada" title="LI12223">Jogada</a> -&gt; <a href="LI12223.html#t:Jogo" title="LI12223">Jogo</a> <a href="#v:animaJogo" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <strong>animaJogo</strong> que recebe um Jogo e uma jogada que &quot;d&#225;&quot; movimento ao <a href="Jogo.html">Jogo</a> criado pelas func&#245;es auxiliares retornando um Jogo.</p><p>A fun&#231;&#227;o aplica anima&#231;&#227;o ao Jogo atrav&#233;s de 2 fun&#231;&#245;es auxiliares principais, uma que movimenta o mapa e outra que faz moviementar o personagem, na fun&#231;&#227;o principal vai juntar as fun&#231;&#245;es auxiliares de modo a criar um tipo de anima&#231;&#227;o ao Jogo.</p><p><strong>O moviemnto do jogador n&#227;o acontece se e s&#243; se o local para onde ele se for mover for ocupado por uma &#225;rvore.</strong></p><p>A fun&#231;&#227;o pode ser definida da seguinte forma:</p><pre>animaJogo :: Jogo -&gt; Jogada -&gt; Jogo
animaJogo (Jogo (Jogador (x,y)) (Mapa l ((t,(o:os)):r))) (Move d) | d == Cima = jogadorMove (Jogo (Jogador (x,y)) (moverObstaculos (Mapa l ((t,(o:os)):r)))) (Move Cima)
                                                                  | d == Baixo = jogadorMove (Jogo (Jogador (x,y)) (moverObstaculos (Mapa l ((t,(o:os)):r)))) (Move Baixo)
                                                                  | d == Direita = jogadorMove (Jogo (Jogador (x,y)) (moverObstaculos (Mapa l ((t,(o:os)):r)))) (Move Direita)
                                                                  | d == Esquerda = jogadorMove (Jogo (Jogador (x,y)) (moverObstaculos (Mapa l ((t,(o:os)):r)))) (Move Esquerda)
animaJogo (Jogo (Jogador (x,y)) (Mapa l ((t,(o:os)):r))) (Parado) = jogadorMove (Jogo (Jogador (x,y)) (moverObstaculos (Mapa l ((t,(o:os)):r)))) (Parado)
</pre><h2>Exemplos de utiliza&#231;&#227;o</h2><h3>Exemplo 1 - Movimenta Para Cima</h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>animaJogo (Jogo (Jogador (1,2)) (Mapa 4 ([(Rio 2,[Tronco,Nenhum,Tronco,Nenhum]),(Estrada (-2),[Carro,Carro,Nenhum,Nenhum]),(Relva,[Arvore,Nenhum,Arvore,Nenhum]),(Rio 3,[Tronco,Nenhum,Tronco,Tronco])]))) (Move Cima)
</code></strong>Jogo (Jogador (1,1)) (Mapa 4 [(Rio 2,[Tronco,Nenhum,Tronco,Nenhum]),(Estrada (-2),[Nenhum,Nenhum,Carro,Carro]),(Relva,[Arvore,Nenhum,Arvore,Nenhum]),(Rio 3,[Nenhum,Tronco,Tronco,Tronco])])
</pre><h3>Exemplo 2 - Movimenta Para Baixo (Com Uma &#193;rvore em Baixo)</h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>animaJogo (Jogo (Jogador (2,1)) (Mapa 4 ([(Rio (-3),[Tronco,Nenhum,Tronco,Nenhum]),(Estrada (-2),[Carro,Carro,Nenhum,Nenhum]),(Relva,[Arvore,Nenhum,Arvore,Nenhum]),(Rio 1,[Tronco,Nenhum,Tronco,Tronco])]))) (Move Baixo)
</code></strong>Jogo (Jogador (2,1)) (Mapa 4 [(Rio (-3),[Nenhum,Tronco,Nenhum,Tronco]),(Estrada (-2),[Nenhum,Nenhum,Carro,Carro]),(Relva,[Arvore,Nenhum,Arvore,Nenhum]),(Rio 1,[Tronco,Tronco,Nenhum,Tronco])])
</pre></div></div><a href="#g:2" id="g:2"><h1>Fun&#231;&#245;es auxiliares</h1></a><div class="top"><p class="src"><a id="v:moverObstaculos" class="def">moverObstaculos</a> :: <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a> -&gt; <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a> <a href="#v:moverObstaculos" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa3_2022li1g011.html#v:moverObstaculos" title="Tarefa3_2022li1g011">moverObstaculos</a></code> &#233; uma fun&#231;&#227;o auxiliar que requer 2 auxiliares a fun&#231;&#227;o <code><a href="Tarefa3_2022li1g011.html#v:moverObstaculosLinha" title="Tarefa3_2022li1g011">moverObstaculosLinha</a></code> e a fun&#231;&#227;o <code><a href="Tarefa3_2022li1g011.html#v:moverObstaculosVelocidade" title="Tarefa3_2022li1g011">moverObstaculosVelocidade</a></code>, que gera movimentos dos obstaculos no mapa, e.g. Um Rio de velocidade 2 [Tronco,Nenhum,Tronco,Tronco] = [Tronco,Tronco,Tronco,Nenhum] (Se a velocidade for negativa o movimento ser&#225; feito no sentido contr&#225;rio.).</p><p>Quando v &gt; 0 os obstaculos movem-se da esquerda para a direita, quando v &lt; 0 os obstaculos movem-se da direita para a esquerda.</p><p>A fun&#231;&#227;o pode ser definida da seguinte forma:</p><pre>moverObstaculos :: Mapa -&gt; Mapa
moverObstaculos (Mapa l ((t, (o:os)):r)) = (Mapa l (moverObstaculosLinha((t,(o:os)):r)))
</pre><h2>Exemplos de utiliza&#231;&#227;o</h2><h3>Exemplo 1 - Mover Obstaculos Em dire&#231;&#245;es opostas</h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>moverObstaculos (Mapa 3 ([(Rio 2,[Tronco,Nenhum,Tronco]),(Estrada (-2),[Carro,Carro,Nenhum ])]))
</code></strong>Mapa 3 [(Rio 2,[Nenhum,Tronco,Tronco]),(Estrada (-2),[Nenhum,Carro,Carro])]
</pre><h3>Exemplo 2 - Mover Obstaculos na mesma dire&#231;&#227;o </h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>moverObstaculos (Mapa 3 ([(Rio 2,[Tronco,Nenhum,Tronco,Nenhum]),(Estrada 2,[Carro,Carro,Nenhum,Carro])]))
</code></strong>Mapa 3 [(Rio 2,[Tronco,Nenhum,Tronco,Nenhum]),(Estrada 2,[Nenhum,Carro,Carro,Carro])]
</pre></div></div><div class="top"><p class="src"><a id="v:atropelamento" class="def">atropelamento</a> :: Int -&gt; <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a> -&gt; <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a> <a href="#v:atropelamento" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:moverObstaculosLinha" class="def">moverObstaculosLinha</a> :: [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])] -&gt; [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])] <a href="#v:moverObstaculosLinha" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <strong>moverObstaculosLinha</strong> &#233; uma fun&#231;&#227;o auxiliar da fun&#231;&#227;o <strong>moverObstaculos</strong>, uma fun&#231;&#227;o que funciona em conjunto com outra fun&#231;&#227;o auxiliar da fun&#231;&#227;o <strong>moverObstaculos</strong>, esta fun&#231;&#227;o utiliza a fun&#231;&#227;o <strong>moverObstaculosVelocidade</strong> que funciona como um contador recebendo o INT 0 e adicinando 1 at&#233; ser o mesmo valor da velocidade do terreno que est&#225; a ser movido.</p><p>A fun&#231;&#227;o pode ser definida da seguinte forma:</p><pre>moverObstaculosLinha :: [(Terreno,[Obstaculo])] -&gt; [(Terreno,[Obstaculo])]
moverObstaculosLinha [] = []
moverObstaculosLinha ((t,(o:os)):r) | r == [] = [moverObstaculosVelocidade ((t,(o:os)):r) 0]
                                   | otherwise = (moverObstaculosVelocidade ((t,(o:os)):r) 0): moverObstaculosLinha r
</pre><h2>Exemplos de utiliza&#231;&#227;o</h2><h3>Exemplo 1 - Movimenta os obstaculos &quot;v&quot; vezes na dire&#231;&#227;o pretendida</h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>moverObstaculosLinha [(Estrada 2,[Nenhum,Carro,Carro,Carro])]
</code></strong>[(Estrada 2,[Carro,Carro,Nenhum,Carro])]
</pre></div></div><div class="top"><p class="src"><a id="v:atropelamentoLinha" class="def">atropelamentoLinha</a> :: Int -&gt; [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])] -&gt; [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])] <a href="#v:atropelamentoLinha" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:moverObstaculosVelocidade" class="def">moverObstaculosVelocidade</a> :: [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])] -&gt; Int -&gt; (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]) <a href="#v:moverObstaculosVelocidade" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <strong>moverObstaculosVelocidade</strong> &#233; uma fun&#231;&#227;o auxiliar da fun&#231;&#227;o <strong>moverObstaculos</strong>, uma fun&#231;&#227;o que funciona em conjunto com a fun&#231;&#227;o <strong>moverObstaculosLinha</strong> mencionada em cima, esta fun&#231;&#227;o &#233; uma especie de contador que come&#231;a no 0 ate chegar ao valor v do terreno em quest&#227;o.</p><p>A fun&#231;&#227;o pode ser definida da seguinte forma:</p><pre>moverObstaculosVelocidade ::  [(Terreno,[Obstaculo])] -&gt; Int -&gt;  (Terreno,[Obstaculo])
moverObstaculosVelocidade ((Rio v, (o:os)):r) x | v &gt; 0 &amp;&amp; x /= v = (moverObstaculosVelocidade ((Rio v, (last os : o : init os)):r) (x+1))
                                                | v &lt; 0 &amp;&amp; x /= v = (moverObstaculosVelocidade ((Rio v, (os ++ [o])):r) (x-1))
                                                | otherwise =  ((Rio v, (o:os)))
moverObstaculosVelocidade ((Estrada v, (o:os)):r) x | v &gt; 0 &amp;&amp; x /= v = (moverObstaculosVelocidade ((Estrada v, (last os : o : init os)):r) (x+1))
                                                    | v &lt; 0 &amp;&amp; x /= v = (moverObstaculosVelocidade ((Estrada v, (os ++ [o])):r) (x-1))
                                                    | otherwise = ((Estrada v, (o:os)))
moverObstaculosVelocidade ((Relva,(o:os)):r) x = (Relva, (o:os))
</pre><h2>Exemplos de utiliza&#231;&#227;o</h2><h3>Exemplo 1 - Move os obstaculos 2x para a direita</h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>[(Estrada 2,[Nenhum,Carro,Carro,Carro])] 0
</code></strong>(Estrada 2,[Carro,Carro,Nenhum,Carro])
</pre></div></div><div class="top"><p class="src"><a id="v:jogadorMove" class="def">jogadorMove</a> :: <a href="LI12223.html#t:Jogo" title="LI12223">Jogo</a> -&gt; <a href="LI12223.html#t:Jogada" title="LI12223">Jogada</a> -&gt; <a href="LI12223.html#t:Jogo" title="LI12223">Jogo</a> <a href="#v:jogadorMove" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <strong>jogadorMove</strong> &#233; uma fun&#231;&#227;o auxiliar, que movimenta o jogador no mapa , tendo em aten&#231;&#227;o que o jogador n&#227;o conseguira mover-se para o local onde est&#225; uma arv&#243;re.</p><p>Tamb&#233;m nesta fun&#231;&#227;o temos o caso <a href="Parado.html">Parado</a>, que no caso de se encontrar num <a href="Tronco.html">Tronco</a> acompanhar&#225; o movimento do tronco.</p><p>A fun&#231;&#227;o pode ser definida da seguinte forma:</p><pre>

jogadorMove :: Jogo -&gt; Jogada -&gt; Jogo
jogadorMove (Jogo (Jogador (x,y)) (Mapa l linhas<code>((t,(o:os)):r))) (Move Baixo) | (y+1) &gt;= (length (listaTerrenos ((t,(o:os)):r))) =jogadorMove (Jogo (Jogador (x,y)) ((Mapa l ((t,(o:os)):r)))) (Parado)
                                                                        | qualTerreno (qualTerrenoObs (Mapa l ((t,(o:os)):r)) (y+1)) == Relva &amp;&amp; (qualObs (qualTerrenoObs (Mapa l ((t,(o:os)):r)) (y+1))!!(x)) == Arvore = jogadorMove (Jogo (Jogador (x,y)) ((Mapa l ((t,(o:os)):r)))) (Parado)
                                                                          |(existeCarro x (linhas !! (y+1))) == True = (Jogo (Jogador (x,y+1)) (atropelamento x (Mapa l ((t,(o:os)):r))))
--                                                                         | qualTerreno (qualTerrenoObs (Mapa l ((t,(o:os)):r)) (y+1)) == Estrada ((qualV (qualTerrenoObs (Mapa l ((t,(o:os)):r)) (y+1)))) &amp;&amp; (qualObs (qualTerrenoObs (Mapa l ((t,(o:os)):r)) (y+1))!!(x)) == Carro = (Jogo (Jogador (99,99)) (atropelamento (Mapa l ((t,(o:os)):r))))
                                                                        | otherwise = (Jogo (Jogador (x,y+1)) (moverObstaculos (Mapa l ((t,(o:os)):r))))

jogadorMove (Jogo (Jogador (x,y)) (Mapa l linhas</code>((t,(o:os)):r))) (Move Esquerda) | x == 0 || (x-1) &lt; 0 =jogadorMove (Jogo (Jogador (x,y)) ((Mapa l ((t,(o:os)):r)))) (Parado)
                                                                           | qualTerreno (qualTerrenoObs (Mapa l ((t,(o:os)):r)) y) == Relva &amp;&amp; (qualObs (qualTerrenoObs (Mapa l ((t,(o:os)):r)) y)!!(x-1)) == Arvore = jogadorMove (Jogo (Jogador (x,y)) ((Mapa l ((t,(o:os)):r)))) (Parado)
                                                                           | qualTerreno (qualTerrenoObs (Mapa l ((t,(o:os)):r)) y) == Rio (qualV (qualTerrenoObs (Mapa l ((t,(o:os)):r)) y)) &amp;&amp; (qualV (qualTerrenoObs (Mapa l ((t,(o:os)):r)) y))&gt;0 &amp;&amp; (qualObs (qualTerrenoObs (Mapa l ((t,(o:os)):r)) y)!!x) == Tronco = (Jogo (Jogador (x+(qualV (qualTerrenoObs (Mapa l ((t,(o:os)):r)) y))-1,y)) (moverObstaculos (Mapa l ((t,(o:os)):r))))
                                                                           | qualTerreno (qualTerrenoObs (Mapa l ((t,(o:os)):r)) y) == Rio (qualV (qualTerrenoObs (Mapa l ((t,(o:os)):r)) y)) &amp;&amp; (qualV (qualTerrenoObs (Mapa l ((t,(o:os)):r)) y))&lt;0 &amp;&amp; (qualObs (qualTerrenoObs (Mapa l ((t,(o:os)):r)) y)!!x) == Tronco = (Jogo (Jogador (x-(qualV (qualTerrenoObs (Mapa l ((t,(o:os)):r)) y))-1,y)) (moverObstaculos (Mapa l ((t,(o:os)):r))))
                                                                           |(existeCarro (x-1) (linhas !! y)) == True = (Jogo (Jogador (x-1,y)) (atropelamento x (Mapa l ((t,(o:os)):r))))
--                                                                            | qualTerreno (qualTerrenoObs (Mapa l ((t,(o:os)):r)) y) == Estrada (qualV (qualTerrenoObs (Mapa l ((t,(o:os)):r)) y)) &amp;&amp; (qualObs (qualTerrenoObs (Mapa l ((t,(o:os)):r)) y)!!(x-1)) == Carro = (Jogo (Jogador (99,99)) (atropelamento (Mapa l ((t,(o:os)):r))))
                                                                           | otherwise = (Jogo (Jogador (x-1,y)) (moverObstaculos (Mapa l ((t,(o:os)):r))))


jogadorMove (Jogo (Jogador (x,y)) (Mapa l linhas<code>((t,(o:os)):r))) (Move Direita) | x == 0 || (x+1) &gt; l =jogadorMove (Jogo (Jogador (x,y)) ((Mapa l ((t,(o:os)):r)))) (Parado)
                                                                     --     | qualTerreno (qualTerrenoObs (Mapa l ((t,(o:os)):r)) y) == Estrada (qualV (qualTerrenoObs (Mapa l ((t,(o:os)):r)) y)) &amp;&amp; (qualObs (qualTerrenoObs (Mapa l ((t,(o:os)):r)) y)!!(x-1)) == Carro = (Jogo (Jogador (x,y)) ((Mapa l ((t,(o:os)):r))))
                                                                          | qualTerreno (qualTerrenoObs (Mapa l ((t,(o:os)):r)) y) == Relva &amp;&amp; (qualObs (qualTerrenoObs (Mapa l ((t,(o:os)):r)) y)!!(x+1)) == Arvore = jogadorMove (Jogo (Jogador (x,y)) ((Mapa l ((t,(o:os)):r)))) (Parado)
                                                                          | qualTerreno (qualTerrenoObs (Mapa l ((t,(o:os)):r)) y) == Rio (qualV (qualTerrenoObs (Mapa l ((t,(o:os)):r)) y)) &amp;&amp; (qualV (qualTerrenoObs (Mapa l ((t,(o:os)):r)) y))&gt;0 &amp;&amp; (qualObs (qualTerrenoObs ((Mapa l ((t,(o:os)):r))) y)!!x) == Tronco = (Jogo (Jogador ((x+1+(qualV (qualTerrenoObs (Mapa l ((t,(o:os)):r)) y))),y)) (moverObstaculos (Mapa l ((t,(o:os)):r))))
                                                                          | qualTerreno (qualTerrenoObs (Mapa l ((t,(o:os)):r)) y) == Rio (qualV (qualTerrenoObs (Mapa l ((t,(o:os)):r)) y)) &amp;&amp; (qualV (qualTerrenoObs (Mapa l ((t,(o:os)):r)) y))&lt;0 &amp;&amp; (qualObs (qualTerrenoObs ((Mapa l ((t,(o:os)):r))) y)!!x) == Tronco = (Jogo (Jogador (x+1+(qualV (qualTerrenoObs (Mapa l ((t,(o:os)):r)) y)),y)) (moverObstaculos (Mapa l ((t,(o:os)):r))))
                                                                          |(existeCarro (x+1) (linhas !! y)) == True = (Jogo (Jogador (x+1,y)) (atropelamento x (Mapa l ((t,(o:os)):r))))
                                                                          | otherwise = (Jogo (Jogador (x+1,y)) (moverObstaculos (Mapa l ((t,(o:os)):r))))

jogadorMove (Jogo (Jogador (x,y)) (Mapa l linhas</code>((t,(o:os)):r))) (Move Cima) | (y-1) &lt; 0 =jogadorMove (Jogo (Jogador (x,y)) ((Mapa l ((t,(o:os)):r)))) (Parado)
                                                                      -- | qualTerreno (qualTerrenoObs (Mapa l ((t,(o:os)):r)) (y-1)) == Estrada (qualV (qualTerrenoObs (Mapa l ((t,(o:os)):r)) (y-1))) &amp;&amp; (qualObs (qualTerrenoObs (Mapa l ((t,(o:os)):r)) (y-1))!!x) == Carro = (Jogo (Jogador (x,y)) (atropelamento x (Mapa l ((t,(o:os)):r))))
                                                                       | qualTerreno (qualTerrenoObs (Mapa l ((t,(o:os)):r)) (y-1)) == Relva &amp;&amp; (qualObs (qualTerrenoObs (Mapa l ((t,(o:os)):r)) (y-1))!!(x)) == Arvore = jogadorMove (Jogo (Jogador (x,y)) ((Mapa l ((t,(o:os)):r)))) (Parado)
                                                                       |(existeCarro x (linhas !! (y-1))) == True = (Jogo (Jogador (x,y-1)) (atropelamento x (Mapa l ((t,(o:os)):r))))
                                                                       | otherwise = (Jogo (Jogador (x,y-1)) (moverObstaculos (Mapa l ((t,(o:os)):r))))

jogadorMove (Jogo (Jogador (x,y)) (Mapa l linhas@((t,(o:os)):r))) (Parado) | qualTerreno (qualTerrenoObs (Mapa l ((t,(o:os)):r)) y) == Rio (qualV (qualTerrenoObs (Mapa l ((t,(o:os)):r)) y)) &amp;&amp; (qualV (qualTerrenoObs (Mapa l ((t,(o:os)):r)) y))&gt;0 &amp;&amp; (qualObs (qualTerrenoObs ((Mapa l ((t,(o:os)):r))) y)!!x) == Tronco = (Jogo (Jogador (x+(qualV (qualTerrenoObs (Mapa l ((t,(o:os)):r)) y)),y)) (moverObstaculos (Mapa l ((t,(o:os)):r))))
                                                                           | qualTerreno (qualTerrenoObs (Mapa l ((t,(o:os)):r)) y) == Rio (qualV (qualTerrenoObs (Mapa l ((t,(o:os)):r)) y)) &amp;&amp; (qualV (qualTerrenoObs (Mapa l ((t,(o:os)):r)) y))&lt;0 &amp;&amp; (qualObs (qualTerrenoObs ((Mapa l ((t,(o:os)):r))) y)!!x) == Tronco = (Jogo (Jogador (x+(qualV (qualTerrenoObs (Mapa l ((t,(o:os)):r)) y)),y)) (moverObstaculos (Mapa l ((t,(o:os)):r))))
                                                                           | (existeCarro x (linhas !! y)) == True = (Jogo (Jogador (x,y)) (atropelamento x (Mapa l ((t,(o:os)):r))))
                                                                           | otherwise = (Jogo (Jogador (x,y)) (moverObstaculos (Mapa l ((t,(o:os)):r))))
</pre><h2>Exemplos de utiliza&#231;&#227;o</h2><h3>Exemplo 1 - Move Esquerda (V&#225;lido)</h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>jogadorMove (Jogo (Jogador (1,2)) (Mapa 4 [(Estrada 3,[Carro,Carro,Nenhum,Nenhum]),(Relva,[Arvore,Arvore,Nenhum,Arvore]),(Rio (-5),[Tronco,Nenhum,Tronco,Nenhum])])) (Move Esquerda)
</code></strong>Jogo (Jogador (0,2)) (Mapa 4 [(Estrada 3,[Carro,Carro,Nenhum,Nenhum]),(Relva,[Arvore,Arvore,Nenhum,Arvore]),(Rio (-5),[Tronco,Nenhum,Tronco,Nenhum])])
</pre><h3>Exemplo 2 - Move Esquerda (Inv&#225;lido)</h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>jogadorMove (Jogo (Jogador (2,1)) (Mapa 4 [(Estrada 3,[Carro,Carro,Nenhum,Nenhum]),(Relva,[Arvore,Arvore,Nenhum,Arvore]),(Rio (-5),[Tronco,Nenhum,Tronco,Nenhum])])) (Move Esquerda)
</code></strong>Jogo (Jogador (2,1)) (Mapa 4 [(Estrada 3,[Carro,Carro,Nenhum,Nenhum]),(Relva,[Arvore,Arvore,Nenhum,Arvore]),(Rio (-5),[Tronco,Nenhum,Tronco,Nenhum])])
</pre></div></div><div class="top"><p class="src"><a id="v:qualTerrenoObs" class="def">qualTerrenoObs</a> :: <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a> -&gt; Int -&gt; (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]) <a href="#v:qualTerrenoObs" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa3_2022li1g011.html#v:qualTerrenoObs" title="Tarefa3_2022li1g011">qualTerrenoObs</a></code> &#233; uma fun&#231;&#227;o auxiliar da fun&#231;&#227;o <code><a href="Tarefa3_2022li1g011.html#v:jogadorMove" title="Tarefa3_2022li1g011">jogadorMove</a></code>, uma fun&#231;&#227;o que funciona dando um Mapa e um Int (que &#233; o y) d&#225; a linha em que o jogador est&#225; usado para ver se se pode mover.</p><p>A fun&#231;&#227;o pode ser definida da seguinte forma:</p><pre>qualTerrenoObs :: Mapa -&gt; Int -&gt; (Terreno,[Obstaculo])
qualTerrenoObs (Mapa l ((t,(o:os)):r)) n = (((t,(o:os)):r))!!(n)
</pre><h2>Exemplos de utiliza&#231;&#227;o</h2><h3>Exemplo 1 - Utilizando o Int 1 verificamos em linha est&#225; o personagem</h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>qualTerrenoObs (Mapa 4 [(Estrada 3,[Carro,Carro,Nenhum,Nenhum]),(Relva,[Arvore,Arvore,Nenhum,Arvore]),(Rio (-5),[Tronco,Nenhum,Tronco,Nenhum])]) 1
</code></strong>(Relva,[Arvore,Arvore,Nenhum,Arvore])
</pre></div></div><div class="top"><p class="src"><a id="v:qualTerreno" class="def">qualTerreno</a> :: (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]) -&gt; <a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a> <a href="#v:qualTerreno" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa3_2022li1g011.html#v:qualTerreno" title="Tarefa3_2022li1g011">qualTerreno</a></code> &#233; uma fun&#231;&#227;o auxiliar da fun&#231;&#227;o <code><a href="Tarefa3_2022li1g011.html#v:jogadorMove" title="Tarefa3_2022li1g011">jogadorMove</a></code>, uma fun&#231;&#227;o que funciona dando um Terreno e uma Lista de Obstaculos d&#225; o terreno em que jogador est&#225; para ser usado como futura restri&#231;&#227;o.</p><p>A fun&#231;&#227;o pode ser definida da seguinte forma:</p><pre>qualTerreno :: (Terreno,[Obstaculo]) -&gt; Terreno
qualTerreno (t,(o:os)) = t 
</pre><h2>Exemplos de utiliza&#231;&#227;o</h2><h3>Exemplo 1 - D&#225; nos o nome do Terreno em que o personagem est&#225;</h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>qualTerreno (Estrada 3,[Carro,Carro,Nenhum,Nenhum])
</code></strong>Estrada 3
</pre></div></div><div class="top"><p class="src"><a id="v:qualObs" class="def">qualObs</a> :: (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]) -&gt; [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>] <a href="#v:qualObs" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa3_2022li1g011.html#v:qualObs" title="Tarefa3_2022li1g011">qualObs</a></code> &#233; uma fun&#231;&#227;o auxiliar da fun&#231;&#227;o <code><a href="Tarefa3_2022li1g011.html#v:jogadorMove" title="Tarefa3_2022li1g011">jogadorMove</a></code>, uma fun&#231;&#227;o que funciona dando um Terreno e uma Lista de Obstaculos d&#225; a lista de Obstaculos da linha em que jogador est&#225; para ser usado como futura restri&#231;&#227;o.</p><p>A fun&#231;&#227;o pode ser definida da seguinte forma:</p><pre>qualObs :: (Terreno,[Obstaculo]) -&gt; [Obstaculo]
qualObs (t,(o:os)) = (o:os)
</pre><h2>Exemplos de utiliza&#231;&#227;o</h2><h3>Exemplo 1 - D&#225; a lista de Obstaculos da linha em que jogador est&#225;</h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>qualObs (Estrada 3,[Carro,Carro,Nenhum,Nenhum])
</code></strong>[Carro,Carro,Nenhum,Nenhum]
</pre></div></div><div class="top"><p class="src"><a id="v:listaTerrenos" class="def">listaTerrenos</a> :: [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])] -&gt; [<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>] <a href="#v:listaTerrenos" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa3_2022li1g011.html#v:listaTerrenos" title="Tarefa3_2022li1g011">listaTerrenos</a></code> &#233; uma fun&#231;&#227;o auxiliar da fun&#231;&#227;o <code><a href="Tarefa3_2022li1g011.html#v:jogadorMove" title="Tarefa3_2022li1g011">jogadorMove</a></code>, uma fun&#231;&#227;o que funciona dando uma lista de Terreno e uma Lista de Obstaculos d&#225; a lista de Terrenos para ser usado como futura restri&#231;&#227;o.</p><p>A fun&#231;&#227;o pode ser definida da seguinte forma:</p><pre>listaTerrenos :: [(Terreno,[Obstaculo])] -&gt; [Terreno]
listaTerrenos [] = []
listaTerrenos ((t,(o:os)):r) = t : listaTerrenos r
</pre><h2>Exemplos de utiliza&#231;&#227;o</h2><h3>Exemplo 1 - D&#225; a lista de Obstaculos da linha em que jogador est&#225;</h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>listaTerrenos [(Estrada 2,[Carro, Carro, Carro, Nenhum]),(Rio 3,[Tronco,Tronco,Nenhum,Nenhum])]
</code></strong>[Estrada 2,Rio 3]
</pre></div></div><div class="top"><p class="src"><a id="v:qualV" class="def">qualV</a> :: (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]) -&gt; Int <a href="#v:qualV" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa3_2022li1g011.html#v:qualV" title="Tarefa3_2022li1g011">qualV</a></code> &#233; uma fun&#231;&#227;o auxiliar da fun&#231;&#227;o <code><a href="Tarefa3_2022li1g011.html#v:jogadorMove" title="Tarefa3_2022li1g011">jogadorMove</a></code>, uma fun&#231;&#227;o que funciona dando um Terreno e uma Lista de Obstaculos d&#225; a velocidade do terreno para ser usado como futura restri&#231;&#227;o,(esta fun&#231;&#227;o s&#243; &#233; usada para rio pois s&#243; &#233; para o caso do movimento parado em cima de um tronco.).</p><p>A fun&#231;&#227;o pode ser definida da seguinte forma:</p><pre>qualV :: (Terreno,[Obstaculo]) -&gt; Int
qualV (Rio v,(o:os)) = v
</pre><h2>Exemplos de utiliza&#231;&#227;o</h2><h3>Exemplo 1 - D&#225; a velocidade do RIo onde o jogador est&#225; </h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>qualV (Rio 3,[Tronco, Tronco, Nenhum ])
</code></strong>3
</pre></div></div><div class="top"><p class="src"><a id="v:existeCarro" class="def">existeCarro</a> :: Int -&gt; (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]) -&gt; Bool <a href="#v:existeCarro" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:localizarCarro" class="def">localizarCarro</a> :: Int -&gt; (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]) -&gt; Int <a href="#v:localizarCarro" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:atropelamentoAndar" class="def">atropelamentoAndar</a> :: [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])] -&gt; Int -&gt; (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]) <a href="#v:atropelamentoAndar" class="selflink">#</a></p></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.26.0</p></div></body></html>