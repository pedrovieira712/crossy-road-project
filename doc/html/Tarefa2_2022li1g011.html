<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Tarefa2_2022li1g011</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption empty">&nbsp;</span><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>Pedro Seabra Vieira &lt;a104352@alunos.uminho.pt&gt;<br />Pedro Filipe Maneta Pinto &lt;a104176@alunos.uminho.pt&gt;</td></tr><tr><th>Safe Haskell</th><td>Safe-Inferred</td></tr></table><p class="caption">Tarefa2_2022li1g011</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>M&#243;dulo para a realiza&#231;&#227;o da Tarefa 2 do projeto de LI1 em 2022/23.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:estendeMapa">estendeMapa</a> :: <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a> -&gt; Int -&gt; <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a></li><li class="src short"><a href="#v:velocidadeRandomAux">velocidadeRandomAux</a> :: Int -&gt; Int</li><li class="src short"><a href="#v:velocidadeRandomRioPositivo">velocidadeRandomRioPositivo</a> :: Int -&gt; Int</li><li class="src short"><a href="#v:velocidadeRandomRioNegativo">velocidadeRandomRioNegativo</a> :: Int -&gt; Int</li><li class="src short"><a href="#v:velocidadeRandom">velocidadeRandom</a> :: Int -&gt; [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])] -&gt; <a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a></li><li class="src short"><a href="#v:completarLinha">completarLinha</a> :: Int -&gt; [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])] -&gt; Int -&gt; [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])]</li><li class="src short"><a href="#v:escolherTerrenoRandom">escolherTerrenoRandom</a> :: <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a> -&gt; Int -&gt; [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])]</li><li class="src short"><a href="#v:escolherRandom">escolherRandom</a> :: [a] -&gt; Int -&gt; a</li><li class="src short"><a href="#v:terrenoRandom">terrenoRandom</a> :: [a] -&gt; Int -&gt; [Int]</li><li class="src short"><a href="#v:escolherNumero">escolherNumero</a> :: [Int] -&gt; Int</li><li class="src short"><a href="#v:proximosTerrenosValidos">proximosTerrenosValidos</a> :: <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a> -&gt; [<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>]</li><li class="src short"><a href="#v:proximosObstaculosValidos">proximosObstaculosValidos</a> :: Int -&gt; (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]) -&gt; [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]</li><li class="src short"><a href="#v:obstaculosValidosAux">obstaculosValidosAux</a> :: [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>] -&gt; [[<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]]</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:estendeMapa" class="def">estendeMapa</a> :: <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a> -&gt; Int -&gt; <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a> <a href="#v:estendeMapa" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2022li1g011.html#v:estendeMapa" title="Tarefa2_2022li1g011">estendeMapa</a></code> vai gerar e adicionar uma nova linha v&#225;lida ao topo de um dado mapa v&#225;lido. Ou seja est&#225; fun&#231;&#227;o vai receber um mapa v&#225;lido e um inteiro (seed) que &#233; um inteiro aleat&#243;rio (no intervalo [0,100]) que foi usado para acrescentar alguma pseudo-aleatoriedade &#224; gera&#231;&#227;o da nova linha.</p><p>Para esta fun&#231;&#227;o foi utilizada v&#225;rias outras fun&#231;oes auxiliares.</p><p>A fun&#231;&#227;o ainda utiliza uma seed, que &#233; uma valor inteiro que o gerador vai se basear nele para gerar novos n&#250;meros<em>obst&#225;culos</em>terrenos.</p><p>A fun&#231;&#227;o pode ser definida da seguinte forma:</p><pre>estendeMapa :: Mapa -&gt; Int -&gt; Mapa
estendeMapa mapa@(Mapa l ((t,(o:os)):r)) seed | 0 &lt;= seed &amp;&amp; seed &lt;= 100 = (Mapa l (completarLinha l (escolherTerrenoRandom mapa seed) seed))
                                              | otherwise = error &quot;seed tem que ser entra 0 e 100&quot;
</pre><h2>Exemplos de utiliza&#231;&#227;o</h2><h3>Exemplo 1</h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>estendeMapa (Mapa 4 [(Estrada 3,[Carro,Carro,Nenhum,Nenhum]),(Relva,[Arvore,Arvore,Nenhum,Arvore]),(Rio (-5),[Tronco,Nenhum,Tronco,Nenhum])]) 12
</code></strong>Mapa 4 [(Rio (-1),[Nenhum,Nenhum,Nenhum,Tronco]),(Estrada 3,[Carro,Carro,Nenhum,Nenhum]),(Relva,[Arvore,Arvore,Nenhum,Arvore]),(Rio (-5),[Tronco,Nenhum,Tronco,Nenhum])]
</pre></div></div><div class="top"><p class="src"><a id="v:velocidadeRandomAux" class="def">velocidadeRandomAux</a> :: Int -&gt; Int <a href="#v:velocidadeRandomAux" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2022li1g011.html#v:velocidadeRandomAux" title="Tarefa2_2022li1g011">velocidadeRandomAux</a></code> gera uma velocidade random diferente de 0.</p><p>A fun&#231;&#227;o pode ser definida da seguinte forma:</p><pre>velocidadeRandomAux :: Int -&gt; Int
velocidadeRandomAux l | x == 0 = velocidadeRandomAux l
                      | otherwise = x
                        where x = unsafePerformIO (getStdRandom (randomR (-l, l)))
</pre><h2>Exemplos de utiliza&#231;&#227;o</h2><h3>Exemplo 1</h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>velocidadeRandomAux 2
</code></strong>-2
</pre><h3>Exemplo 2</h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>velocidadeRandomAux 2
</code></strong>1
</pre></div></div><div class="top"><p class="src"><a id="v:velocidadeRandomRioPositivo" class="def">velocidadeRandomRioPositivo</a> :: Int -&gt; Int <a href="#v:velocidadeRandomRioPositivo" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2022li1g011.html#v:velocidadeRandomRioPositivo" title="Tarefa2_2022li1g011">velocidadeRandomRioPositivo</a></code> gera uma velocidade positiva random diferente de 0.</p><p>A fun&#231;&#227;o pode ser definida da seguinte forma:</p><pre>velocidadeRandomAux :: Int -&gt; Int
velocidadeRandomAux l | x == 0 = velocidadeRandomAux l
                      | otherwise = x
                        where x = unsafePerformIO (getStdRandom (randomR (-l, l)))
</pre><h2>Exemplos de utiliza&#231;&#227;o</h2><h3>Exemplo 1</h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>velocidadeRandomRioPositivo 2
</code></strong>2
</pre><h3>Exemplo 2</h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>velocidadeRandomRioPositivo 2
</code></strong>1
</pre></div></div><div class="top"><p class="src"><a id="v:velocidadeRandomRioNegativo" class="def">velocidadeRandomRioNegativo</a> :: Int -&gt; Int <a href="#v:velocidadeRandomRioNegativo" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2022li1g011.html#v:velocidadeRandomRioNegativo" title="Tarefa2_2022li1g011">velocidadeRandomRioNegativo</a></code> gera uma velocidade negativa random diferente de 0.</p><p>A fun&#231;&#227;o pode ser definida da seguinte forma:</p><pre>velocidadeRandomRioNegativo :: Int -&gt; Int
velocidadeRandomRioNegativo l | x == 0 = velocidadeRandomRioNegativo l
                              | otherwise = x
                               where x = unsafePerformIO (getStdRandom (randomR (-l, 0)))
</pre><h2>Exemplos de utiliza&#231;&#227;o</h2><h3>Exemplo 1</h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>velocidadeRandomRioNegativo 2
</code></strong>-2
</pre><h3>Exemplo 2</h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>velocidadeRandomRioPositivo 2
</code></strong>-1
</pre></div></div><div class="top"><p class="src"><a id="v:velocidadeRandom" class="def">velocidadeRandom</a> :: Int -&gt; [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])] -&gt; <a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a> <a href="#v:velocidadeRandom" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2022li1g011.html#v:velocidadeRandom" title="Tarefa2_2022li1g011">velocidadeRandom</a></code> fun&#231;&#227;o auxiliar para fun&#231;&#227;o principal que recebe um inteiro (largura) e recebe a uma lista de linhas (ou seja, lista de pares de terrenos e conjunto de obst&#225;culos), est&#225; fun&#231;&#227;o vai gerar um velocidade random ao terreno quando o mesmo &#233; um rio ou estrada com velocidade igual a 0.</p><p>Nesta fun&#231;&#227;o &#233; utilizada as fun&#231;&#245;es auxiliares: <code><a href="Tarefa2_2022li1g011.html#v:velocidadeRandomAux" title="Tarefa2_2022li1g011">velocidadeRandomAux</a></code>, <code><a href="Tarefa2_2022li1g011.html#v:velocidadeRandomRioNegativo" title="Tarefa2_2022li1g011">velocidadeRandomRioNegativo</a></code> e <code><a href="Tarefa2_2022li1g011.html#v:velocidadeRandomRioPositivo" title="Tarefa2_2022li1g011">velocidadeRandomRioPositivo</a></code>.</p><p>A fun&#231;&#227;o pode ser definida da seguinte forma:</p><pre>velocidadeRandom :: Int -&gt; [(Terreno,[Obstaculo])] -&gt; Terreno
velocidadeRandom l ((Rio 0,(o:os)):(Rio v,(o1:os1)):r) | v &gt; 0 = Rio (velocidadeRandomRioNegativo l)
                                                        | otherwise = Rio (velocidadeRandomRioPositivo l)
velocidadeRandom l ((Estrada 0,(o:os)):r) = Estrada (velocidadeRandomAux l)
velocidadeRandom l ((Rio 0,(o:os)):r) = Rio (velocidadeRandomAux l)
velocidadeRandom l ((t,(o:os)):r) = t

</pre><h2>Exemplos de utiliza&#231;&#227;o</h2><h3>Exemplo 1</h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>velocidadeRandom 3 [(Relva, [Nenhum, Nenhum, Nenhum]),(Rio 1, [Nenhum, Tronco, Tronco]),(Relva, [Nenhum, Nenhum, Nenhum])]
</code></strong>Relva
</pre><h3>Exemplo 2</h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>velocidadeRandom 3 [(Rio 0, [Nenhum, Tronco, Tronco]),(Relva, [Nenhum, Nenhum, Nenhum])]
</code></strong>Rio -1
</pre></div></div><div class="top"><p class="src"><a id="v:completarLinha" class="def">completarLinha</a> :: Int -&gt; [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])] -&gt; Int -&gt; [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])] <a href="#v:completarLinha" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2022li1g011.html#v:completarLinha" title="Tarefa2_2022li1g011">completarLinha</a></code> recebe a largura do mapa, uma lista de pares de terrenos e lista de obst&#225;culos que foi gerada com o uso de fun&#231;&#245;es auxiliares e um inteiro (seed)</p><p>A fun&#231;&#227;o pode ser definida da seguinte forma:</p><pre>completarLinha :: Int -&gt; [(Terreno,[Obstaculo])] -&gt; Int -&gt; [(Terreno,[Obstaculo])]
completarLinha l ((t,(o:os)):r) seed | l &gt; length (o:os) + 1 = completarLinha l ([(terrenoV,(o:os)++[proximosObstaculosValidos l (t,(o:os)) !! (escolherNumero $ terrenoRandom (proximosObstaculosValidos l (t, (o:os))) seed)])]++r) seed
                                     | otherwise = [(terrenoV,(o:os)++[proximosObstaculosValidos l (t, (o:os)) !! (escolherNumero $ terrenoRandom (proximosObstaculosValidos l (t, (o:os))) seed)])] ++ r
                                     where terrenoV = velocidadeRandom l ((t,(o:os)):r)
</pre><h2>Exemplos de utiliza&#231;&#227;o</h2><h3>Exemplo 1</h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>completarLinha 3 [(Rio 0,[Nenhum]),(Estrada 0,[Carro,Nenhum,Nenhum]),(Relva,[Nenhum,Nenhum,Nenhum])] 12
</code></strong>[(Rio 1,[Nenhum,Nenhum,Tronco]),(Estrada 0,[Carro,Nenhum,Nenhum]),(Relva,[Nenhum,Nenhum,Nenhum])]
</pre></div></div><div class="top"><p class="src"><a id="v:escolherTerrenoRandom" class="def">escolherTerrenoRandom</a> :: <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a> -&gt; Int -&gt; [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])] <a href="#v:escolherTerrenoRandom" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2022li1g011.html#v:escolherTerrenoRandom" title="Tarefa2_2022li1g011">escolherTerrenoRandom</a></code> escolhe um terreno random.</p><p>A fun&#231;&#227;o pode ser definida da seguinte forma:</p><pre>escolherTerrenoRandom :: Mapa -&gt; Int -&gt; [(Terreno,[Obstaculo])]
escolherTerrenoRandom mapa<code>(Mapa l lista</code>((t,(o:os)):r)) seed = [(novoTerreno,[proximosObstaculosValidos l (novoTerreno, []) !! (escolherNumero $ terrenoRandom (proximosObstaculosValidos l (novoTerreno, [])) seed)])] ++ lista
                                                              where novoTerreno = ((proximosTerrenosValidos mapa) !! (escolherNumero $ terrenoRandom (proximosTerrenosValidos mapa) seed))           
</pre><h2>Exemplos de utiliza&#231;&#227;o</h2><h3>Exemplo 1</h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>escolherTerrenoRandom (Mapa 4 [(Estrada 3,[Carro,Carro,Nenhum,Nenhum]),(Relva,[Arvore,Arvore,Nenhum,Arvore]),(Rio (-5),[Tronco,Nenhum,Tronco,Nenhum])]) 12
</code></strong>[(Rio 0,[Nenhum]),(Estrada 3,[Carro,Carro,Nenhum,Nenhum]),(Relva,[Arvore,Arvore,Nenhum,Arvore]),(Rio (-5),[Tronco,Nenhum,Tronco,Nenhum])]
</pre></div></div><div class="top"><p class="src"><a id="v:escolherRandom" class="def">escolherRandom</a> :: [a] -&gt; Int -&gt; a <a href="#v:escolherRandom" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2022li1g011.html#v:escolherRandom" title="Tarefa2_2022li1g011">escolherRandom</a></code> usa as fun&#231;&#245;es auxiliares <em>escolherNumero</em> e <em>terrenoRandom</em> para escolher um elemento da lista &#224; sorte, para esta fun&#231;&#227;o funcionar est&#225; precisa de receber uma lista e um inteiro (seed).</p><p>A fun&#231;&#227;o pode ser definida da seguinte forma:</p><pre>escolherRandom :: [a] -&gt; Int -&gt; a
escolherRandom (t:ts) seed = (t:ts) !! (escolherNumero $ terrenoRandom (t:ts) seed)
</pre><h2>Exemplos de utiliza&#231;&#227;o</h2><h3>Exemplo 1 </h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>escolherRandom [Tronco, Nenhum] 12
</code></strong>Tronco
</pre><h3>Exemplo 2 </h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>escolherRandom [Tronco, Nenhum] 1
</code></strong>Nenhum
</pre></div></div><div class="top"><p class="src"><a id="v:terrenoRandom" class="def">terrenoRandom</a> :: [a] -&gt; Int -&gt; [Int] <a href="#v:terrenoRandom" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2022li1g011.html#v:terrenoRandom" title="Tarefa2_2022li1g011">terrenoRandom</a></code> &#233; uma fun&#231;&#227;o que recebe uma lista e um inteiro, a seed, est&#225; fun&#231;&#227;o vai gerar uma lista de intieros aleat&#243;rios, que depois vai ser escolhido a posi&#231;&#227;o do maior n&#250;mero e assim temos um valor random para pegar num terreno ou obstaculos da lista dos poss&#237;veis aleatoriamente. </p><p>A fun&#231;&#227;o pode ser definida da seguinte forma:</p><pre>terrenoRandom :: [a] -&gt; Int -&gt; [Int]     
terrenoRandom (t:ts) seed = take(length(t:ts)) $ randoms (mkStdGen seed) 
</pre><h2>Exemplos de utiliza&#231;&#227;o</h2><h3>Exemplo 1 </h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>terrenoRandom [(Rio 0),(Estrada 0), (Relva)] 12
</code></strong>[5383096891209391546,3209554951090738563,-6127366005419924004]
</pre><h3>Exemplo 2</h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>terrenoRandom [Tronco,Nenhum] 12
</code></strong>[5383096891209391546,3209554951090738563]
</pre></div></div><div class="top"><p class="src"><a id="v:escolherNumero" class="def">escolherNumero</a> :: [Int] -&gt; Int <a href="#v:escolherNumero" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2022li1g011.html#v:escolherNumero" title="Tarefa2_2022li1g011">escolherNumero</a></code> tem como objetivo dar-nos a posi&#231;&#227;o do maior n&#250;mero da lista, recebendo uma lista de inteiros e devolvendo a posi&#231;&#227;o do maior inteiro da lista.</p><p>A fun&#231;&#227;o pode ser definida da seguinte forma:</p><pre>escolherNumero :: [Int] -&gt; Int
escolherNumero (h:t) = escolherNumeroAux 0 0 h t
             where escolherNumeroAux i im _ [] = im
                   escolherNumeroAux i im x (y:ys) | x &lt; y = escolherNumeroAux (i+1) (i+1) y ys
                                                   | otherwise = escolherNumeroAux (i+1) im x ys
</pre><h2>Exemplos de utiliza&#231;&#227;o</h2><h3>Exemplo 1 </h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>escolherNumero [5383096891209391546,3209554951090738563,-6127366005419924004]
</code></strong>0
</pre><h3>Exemplo 2</h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>escolherNumero  [9,7,3,2,1]
</code></strong>0
</pre></div></div><div class="top"><p class="src"><a id="v:proximosTerrenosValidos" class="def">proximosTerrenosValidos</a> :: <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a> -&gt; [<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>] <a href="#v:proximosTerrenosValidos" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2022li1g011.html#v:proximosTerrenosValidos" title="Tarefa2_2022li1g011">proximosTerrenosValidos</a></code> que recebe um Mapa e uma lista de terrenos poss&#237;veis para a pr&#243;xima linha, para que o mapa seja v&#225;lido.</p><p>A fun&#231;&#227;o pode ser definida da seguinte forma:</p><pre>proximosTerrenosValidos :: Mapa -&gt; [Terreno]
proximosTerrenosValidos (Mapa l ((Rio x,(o1:os1)):(Rio y,(o2:os2)):(Rio z,(o3:os3)):r))| r == [] = [Estrada 0, Relva]
                                                                                       | otherwise = proximosTerrenosValidos (Mapa l ((Rio y,(o2:os2)):(Rio z,(o3:os3)):r))
proximosTerrenosValidos (Mapa l ((Estrada x,(o1:os1)):(Estrada y,(o2:os2)):(Estrada z,(o3:os3)):(Estrada w,(o4:os4)):r)) | r == [] = [Rio 0,Relva]
                                                                                                                         | otherwise = proximosTerrenosValidos (Mapa l ((Estrada y,(o2:os2)):(Estrada z,(o3:os3)):(Estrada w,(o4:os4)):r))
proximosTerrenosValidos (Mapa l ((Relva,(o1:os1)):(Relva,(o2:os2)):(Relva,(o3:os3)):(Relva,(o4:os4)):r)) | r == [] = [Rio 0, Estrada 0]
                                                                                                         | otherwise = proximosTerrenosValidos (Mapa l ((Relva,(o2:os2)):(Relva,(o3:os3)):(Relva,(o4:os4)):r))
proximosTerrenosValidos (Mapa l ((_,(o:os)):r)) = proximosTerrenosValidos (Mapa l r)
proximosTerrenosValidos (Mapa l []) = [Rio 0, Estrada 0, Relva]
</pre><h2>Exemplos de utiliza&#231;&#227;o</h2><h3>Exemplo 1</h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>proximosTerrenosValidos (Mapa 3 [(Rio 2, [Nenhum,Tronco,Nenhum]),(Rio (-2), [Nenhum,Tronco,Nenhum]),(Rio 3, [Tronco,Nenhum,Tronco])])
</code></strong>[Estrada 0,Relva]
</pre><h3>Exemplo 2</h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>proximosTerrenosValidos (Mapa 3 [(Rio 2, [Nenhum,Tronco,Nenhum]),(Estrada 3, [Nenhum,Carro,Nenhum]),(Rio 1, [Tronco,Nenhum,Tronco])])
</code></strong>[Rio 0,Estrada 0,Relva]
</pre></div></div><div class="top"><p class="src"><a id="v:proximosObstaculosValidos" class="def">proximosObstaculosValidos</a> :: Int -&gt; (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]) -&gt; [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>] <a href="#v:proximosObstaculosValidos" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2022li1g011.html#v:proximosObstaculosValidos" title="Tarefa2_2022li1g011">proximosObstaculosValidos</a></code> que recebe um inteiro (a largura do mapa) e um par de um terreno e um conjunto de obst&#225;culos e retorna uma lista de obst&#225;culos poss&#237;veis para o pr&#243;ximo obst&#225;culos dessa linha, para a linha v&#225;lida.</p><p>Para est&#225; fun&#231;&#227;o funcionar corretamente, foi utilizada uma fun&#231;&#227;o auxiliar <em>ObstaculosValidosAux</em>. </p><p>A fun&#231;&#227;o pode ser definida da seguinte forma:</p><pre>proximosObstaculosValidos :: Int -&gt; (Terreno, [Obstaculo]) -&gt; [Obstaculo]
proximosObstaculosValidos l (Estrada x, []) =  [Nenhum, Carro]
proximosObstaculosValidos l (Estrada x, (o:os)) | l == length (o:os) = []
                                                | Carro == head(head(obstaculosValidosAux(o:os))) &amp;&amp; Carro == head(last(obstaculosValidosAux(o:os))) &amp;&amp; (length(last(obstaculosValidosAux(o:os))))+length(head(obstaculosValidosAux (o:os))) &gt;= 3 = [Nenhum]
                                                | Carro == head(head(obstaculosValidosAux(o:os))) &amp;&amp; Carro == head(last(obstaculosValidosAux(o:os))) &amp;&amp; (length(last(obstaculosValidosAux(o:os))))+length(head(obstaculosValidosAux (o:os))) &gt;= 3 &amp;&amp; (l - length(o:os)) &gt; 1 = [Nenhum, Carro]
                                                | not(elem Nenhum (o:os)) &amp;&amp; (l - (length (o:os))) &gt; 1  = [Nenhum, Carro] -- lista n&#227;o completa da nenhum ou carro
                                                | not(elem Nenhum (o:os)) &amp;&amp; (length (o:os)) &lt; l = [Nenhum] -- tem de 1 ter Nenhum pelo menos
                                                | not(elem Nenhum (drop (length (o:os) - 5) (o:os))) &amp;&amp; l == 1 + length(o:os) = [Nenhum] -- (aqui tmb pode receber carro se for nenhum e deopis carro) 
                                                | not(elem Nenhum (o:os)) = [Nenhum, Carro]
                                                | otherwise = [Nenhum, Carro]

proximosObstaculosValidos l (Rio x, []) =  [Nenhum, Tronco]
proximosObstaculosValidos l (Rio x, (o:os)) | l == length (o:os) = []
                                            | Tronco == head(head(obstaculosValidosAux(o:os))) &amp;&amp; Tronco == head(last(obstaculosValidosAux(o:os))) &amp;&amp; (length(last(obstaculosValidosAux(o:os))))+length(head(obstaculosValidosAux (o:os))) &gt;= 5 = [Nenhum]
                                            | Tronco == head(head(obstaculosValidosAux(o:os))) &amp;&amp; Tronco == head(last(obstaculosValidosAux(o:os))) &amp;&amp; (length(last(obstaculosValidosAux(o:os))))+length(head(obstaculosValidosAux (o:os))) &gt;= 5 &amp;&amp; (l - length(o:os)) &gt; 1  = [Nenhum, Tronco]
                                            | not(elem Nenhum (o:os)) &amp;&amp; (l - (length (o:os))) &gt; 1  = [Nenhum, Tronco] -- lista n&#227;o completa da nenhum ou tronco
                                            | not(elem Nenhum (o:os)) &amp;&amp; (length (o:os)) &lt; l = [Nenhum] -- tem de 1 ter Nenhum pelo menos
                                            | not(elem Tronco (o:os)) &amp;&amp; (l - length (o:os)) == 1 = [Tronco]
                                            | not(elem Nenhum (drop (length (o:os) - 5) (o:os))) &amp;&amp; l == 1 + length(o:os) = [Nenhum] 
                                            | not(elem Nenhum (o:os)) = [Nenhum, Tronco]
                                            | otherwise = [Nenhum, Tronco]

proximosObstaculosValidos l (Relva, []) =  [Nenhum, Arvore]
proximosObstaculosValidos l (Relva, (o:os)) | l == length (o:os) = []
                                            | not(elem Nenhum (o:os)) &amp;&amp; (l - (length (o:os))) &gt; 1  = [Nenhum, Arvore] -- lista n&#227;o completa da nenhum ou Arvore
                                            | not(elem Nenhum (o:os)) &amp;&amp; (length (o:os)) &lt; l = [Nenhum] -- tem de 1 ter Nenhum pelo menos
                                            | not(elem Nenhum (drop (length (o:os) - 5) (o:os))) &amp;&amp; l == 1 + length(o:os) = [Nenhum] -- aqui tmb pode receber carro se for nenhum e deopis carro 
                                            | not(elem Nenhum (o:os)) = [Nenhum, Arvore]
                                            | otherwise = [Nenhum, Arvore]
</pre><h2>Exemplos de utiliza&#231;&#227;o</h2><h3>Exemplo 1 </h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>proximosObstaculosValidos 3 (Rio 1, [Nenhum, Nenhum])
</code></strong>[Tronco]
</pre><h3>Exemplo 2 </h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>proximosObstaculosValidos 3 (Rio (-1), [Nenhum, Tronco])
</code></strong>[Nenhum,Tronco]
</pre><h3>Exemplo 3</h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>proximosObstaculosValidos 5 (Estrada 2, [Nenhum, Carro, Carro])
</code></strong>[Nenhum,Carro]
</pre></div></div><div class="top"><p class="src"><a id="v:obstaculosValidosAux" class="def">obstaculosValidosAux</a> :: [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>] -&gt; [[<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]] <a href="#v:obstaculosValidosAux" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2022li1g011.html#v:obstaculosValidosAux" title="Tarefa2_2022li1g011">obstaculosValidosAux</a></code> &#233; uma fun&#231;&#227;o auxiliar da fun&#231;&#227;o proximosObstaculosValidos, est&#225; fun&#231;ao tem com objetivo agrupar elementos iguais e consecutivos de uma lista, recebendo uma lista de obst&#225;culos e devolvendo uma lista de obst&#225;culos organizados.</p><p>A fun&#231;&#227;o pode ser definida da seguinte forma:</p><pre>obstaculosValidosAux :: [Obstaculo] -&gt; [[Obstaculo]]
obstaculosValidosAux [] = []
obstaculosValidosAux [x] = [[x]]
obstaculosValidosAux l = u : obstaculosValidosAux (drop (length u) l)
    where u = uma_lista l
          uma_lista :: Eq a =&gt; [a] -&gt; [a] 
          uma_lista [x] = [x]
          uma_lista (x:y:t) | x == y = x : uma_lista (y:t)
                            | otherwise = [x] 
</pre><h2>Exemplos de utiliza&#231;&#227;o</h2><h3>Exemplo 1 </h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>obstaculosValidosAux [Tronco,Tronco,Nenhum,Tronco,Nenhum,Nenhum,Nenhum]
</code></strong>[[Tronco,Tronco],[Nenhum],[Tronco],[Nenhum,Nenhum,Nenhum]]
</pre></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.26.0</p></div></body></html>